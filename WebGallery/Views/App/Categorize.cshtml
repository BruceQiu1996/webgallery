@model WebGallery.ViewModels.AppCategorizeViewModel

@{
    ViewBag.Title = "Categorize";
    Layout = "~/Views/Shared/_Layout.cshtml";

    var firstIndex = Model.Submissions.Count() == 0 ? (Model.CurrentPage - 1) * 20 : (Model.CurrentPage - 1) * 20 + 1;
    var lastIndex = (Model.CurrentPage - 1) * 20 + Model.Submissions.Count();
}

<div class="content">
    <div class="header">
        @Html.RouteLink("< Go Back to Gallery", SiteRouteNames.Gallery)
        <label>Display Results @firstIndex - @lastIndex For Your Searching , @Model.TotalCount Totally</label>
    </div>
    <hr />
    <div class="categories">
        @Html.HiddenFor(model => model.CurrentCategory)
        @{
            foreach (var c in Model.Categories)
            {
                <div>
                    @Html.RouteLink(c.Name, SiteRouteNames.App_Categorize, new { category = c.Name, supportedLanguage = Model.CurrentSupportedLanguage })
                </div>
                <hr />
            }
        }
        <div>
            <h2>Applications in</h2>
            @using (Html.BeginRouteForm(SiteRouteNames.App_Categorize, new { category = Model.CurrentCategory }))
            {
                @Html.DropDownList("supportedLanguage", new SelectList(Model.SupportedLanguages, "Value", "Key", Model.CurrentSupportedLanguage))
            }
        </div>
    </div>
    <div class="app-list">
        @foreach (var app in Model.Submissions)
        {
            var logourl = string.IsNullOrWhiteSpace(app.LogoUrl) ? "~/Content/images/no-logo.png" : app.LogoUrl;
            var description = app.BriefDescription.Length > 210 ? app.BriefDescription.Substring(0, 210) + "..." : app.BriefDescription;

            <div>
                <div>
                    <a href="@Url.RouteUrl(SiteRouteNames.App_View, new { appId = app.Nickname })"><img src="@Url.Content(logourl)" class="small-icon" /></a>
                </div>
                <div>
                    @Html.RouteLink(app.AppName, SiteRouteNames.App_View, new { appId = app.Nickname })
                    <span>@app.Version</span>
                    <span>Released at: @app.ReleaseDate.ToShortDateString() </span>
                    <p>@description @Html.RouteLink("More Information", SiteRouteNames.App_View, new { appId = app.Nickname })</p>
                </div>
                <hr />
            </div>
        }
    </div>

    <div class="page-switch">
        @Html.Hidden("currentpage", Model.CurrentPage)
        @Html.Hidden("totalpage", Model.TotalPage)
        @Html.RouteLink("Next", SiteRouteNames.App_Categorize, new { page = Model.CurrentPage + 1, supportedLanguage = Model.CurrentSupportedLanguage }, new { id = "nextlink" })
        @Html.RouteLink("Previous", SiteRouteNames.App_Categorize, new { page = Model.CurrentPage - 1, supportedLanguage = Model.CurrentSupportedLanguage }, new { id = "prelink" })
    </div>
</div>

@section Styles {
    @Styles.Render("~/css/app-categorize")
}

@section Scripts {
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/js/app-categorize")
}
@model WebGallery.ViewModels.AppDetailViewModel

@{
    ViewBag.Title = "Windows Web App Gallery" + "-" + Model.MetaData.Name;
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="content">

    @Html.Partial("_TopTabs_SearchBox")

    <div class="app-name">
        <lable>@Model.MetaData.Name</lable>
    </div>
    <div class="app-icon pull-left">
        <img src="@Model.Submission.LogoUrl" class="app-image" />
    </div>
    <div class="pull-left">
        @{
            var i = 0;
            foreach (var screenshot in Model.ScreenshotUrls)
            {
                if (screenshot != null)
                {
                    i++;
                    <div style="display:none">
                        <div class="popup-background"></div>
                        <div class="popup-foreground">
                            <img src="@screenshot" />
                            <div class="page-btn">
                                @if (i > 1)
                                {
                                    <input type="image" onclick="$(this).parent().parent().parent().prev().show(); $(this).parent().parent().parent().hide()" src="~/Content/images/prev-btn.png" />
                                }
                                @if (i < 6 && Model.ScreenshotUrls.ElementAt(i) != null)
                                {
                                    <input type="image" onclick="$(this).parent().parent().parent().next().show(); $(this).parent().parent().parent().hide()" src="~/Content/images/next-btn.png" />
                                }
                            </div>
                            <input type="image" class="popup-close-btn" src="~/content/images/close-btn.png" onclick="$(this).parent().parent().hide(); return false;" />
                        </div>
                    </div>
                }
            }
        }
    </div>
    <div class="detail-list pull-right">
        <div>
            <span class="pull-left">
                <img src="~/content/images/free-icon.png" class="avaliable-free-image" />
            </span>
            <span class="pull-right">
                @using (Html.BeginForm("install", "app", new { id = Model.Submission.SubmissionID }))
                {
                    <input type="image" src="~/content/images/install-btn.jpg" alt="Submit" />
                }
            </span>
        </div>
        <div>
            <span class="pull-left">Category:</span>
            <span class="pull-right">
                @{
                    var name1 = Model.Categories.FirstOrDefault(p => p.CategoryID.ToString() == Model.Submission.CategoryID1).Name;
                    @Html.ActionLink(name1, "Categorize", new { category = name1 });
                    <br />
                    if (Model.Submission.CategoryID2 != null && Model.Submission.CategoryID2 != "0" && Model.Submission.CategoryID1 != Model.Submission.CategoryID2)
                    {
                        var name2 = Model.Categories.FirstOrDefault(p => p.CategoryID.ToString() == Model.Submission.CategoryID2).Name;
                        @Html.ActionLink(name2, "Categorize", new { category = name2 });
                        <br />
                    }
                }
            </span>
        </div>
        <div>
            <span class="pull-left">Publisher:</span>
            <span class="pull-right">
                <a href="@Model.Submission.SubmittingEntityURL">@Model.Submission.SubmittingEntity</a>
            </span>
        </div>
        <div>
            <span class="pull-left">Version:</span>
            <span class="pull-right">@Model.Submission.Version</span>
        </div>
        <div>
            <span class="pull-left">Release Date:</span>
            <span class="pull-right">@Model.Submission.ReleaseDate.ToString("dd/MM/yyyy")</span>
        </div>
    </div>
    <div class="screenshot-link">
        <a onclick="$(this).parent().prev().prev().children(':first').show()">view applicaiton screenshots</a>
    </div>
    <div class="description">
        @if (Model.MetaData.Description.Trim() != "")
            {
            <p>@Model.MetaData.Description</p>
        }
        else
        {
            <p>@Model.MetaData.BriefDescription</p>
        }
    </div>
</div>

@section Styles {
    @Styles.Render("~/css/app-detail")
}
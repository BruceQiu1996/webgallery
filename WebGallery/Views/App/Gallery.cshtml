@model WebGallery.ViewModels.AppGalleryViewModel

@{
    ViewBag.Title = "Gallery";
    Layout = "~/Views/Shared/_Layout.cshtml";

    var firstIndex = Model.AppList.Count() == 0 ? (Model.CurrentPage - 1) * 20 : (Model.CurrentPage - 1) * 20 + 1;
    var lastIndex = (Model.CurrentPage - 1) * 20 + Model.AppList.Count();
}

<div class="content">
    <div class="container-fluid header">
        <label class="pull-left title">Windows Web App Gallery</label>
        @using (Html.BeginRouteForm(SiteRouteNames.Gallery, FormMethod.Post))
        {
            @Html.TextBox("keyword", Model.Keyword, new { id = "SearchText", @class = "search-box pull-left", placeholder = "Searh Apps" })
            <input type="image" src="~/content/images/search-btn.jpg" alt="Submit" class="search-icon pull-left" />
        }
        <p class="app-amount">Display Results @firstIndex - @lastIndex For Your Searching , @Model.TotalCount Totally</p>
    </div>

    @foreach (var app in Model.AppList)
    {
        var logourl = string.IsNullOrWhiteSpace(app.LogoUrl) ? "~/Content/images/no-logo.png" : app.LogoUrl;
        var description = app.BriefDescription.Length > 310 ? app.BriefDescription.Substring(0, 310) + "..." : app.BriefDescription;

        <div class="container-fluid">
            <hr />
            <div class="pull-left  icon-block">
                <a href="@Url.RouteUrl(SiteRouteNames.App_View, new { appId = app.Nickname })"><img src=@Url.Content(logourl) class="small-icon" /></a>
            </div>
            <div>
                <lable class="app-title">@Html.RouteLink(app.AppName, SiteRouteNames.App_View, new { appId = app.Nickname })</lable>
                <span class="version">@app.Version </span>
                <span class="release-date">Released at: @app.ReleaseDate.ToShortDateString()</span>
            </div>
            <div>
                <p>@description<span>@Html.RouteLink("More Information", SiteRouteNames.App_View, new { appId = app.Nickname })</span></p>
            </div>
        </div>
    }

    <div class="container-fluid page-switch">
        <hr />
        @Html.Hidden("currentpage", Model.CurrentPage)
        @Html.Hidden("totalpage", Model.TotalPage)
        @Html.RouteLink("Previous", SiteRouteNames.Gallery, new { keyword = Model.Keyword, page = Model.CurrentPage - 1 }, new { id = "prelink", @class = "pre-page" })
        @Html.RouteLink("Next", SiteRouteNames.Gallery, new { keyword = Model.Keyword, page = Model.CurrentPage + 1 }, new { id = "nextlink", @class = "next-page" })
    </div>
</div>

@section Styles {
    @Styles.Render("~/css/app-gallery")
}

@section Scripts {
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/js/app-gallery")
}